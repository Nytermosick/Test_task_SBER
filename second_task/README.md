# –ó–∞–¥–∞–Ω–∏–µ 2 ‚Äî MPC —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –∫ —Ü–µ–ª–∏ –∏ –æ–±—Ö–æ–¥–æ–º –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π

–¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, —Å–ø–æ—Å–æ–±–Ω—É—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ–¥ **–º–µ–Ω—è—é—â—É—é—Å—è —Ü–µ–ª—å** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—Ä–∏ —ç—Ç–æ–º **–∏–∑–±–µ–≥–∞—Ç—å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π**.

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### MPC-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (`mpc2simulation/mpc.py`)

- –ü–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ **Pinocchio + CasADi**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —É–≥–ª—ã, —Å–∫–æ—Ä–æ—Å—Ç–∏, ‚àÜu, —É—Å–∏–ª–∏—è
  - —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ –∏ —Ç—Ä–µ–∫–∏–Ω–≥-—à—Ç—Ä–∞—Ñ—ã
  - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –≤—ã—Å–æ—Ç—É –∑–≤–µ–Ω—å–µ–≤ (`z ‚â• 0`)
  - –æ–±—Ö–æ–¥ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π (—á–µ—Ä–µ–∑ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–Ω—Ç—Ä–æ–≤ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π)
- –§—É–Ω–∫—Ü–∏—è `enable_obstacle_avoid(...)` –≤–∫–ª—é—á–∞–µ—Ç —É—á—ë—Ç –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π

**–í–º–µ—Å—Ç–æ –ø–µ—Ä–µ—Å—á—ë—Ç–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –≤ —Ñ–æ–Ω–µ** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω **–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π MPC**, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–ª–∏. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è, –≤—Ä–æ–¥–µ –∫–∞–∫, ***Receding Horizon Control (RHC)* —Å –æ–Ω–ª–∞–π–Ω-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ü–µ–ª–∏.**

### –°–∏–º—É–ª—è—Ç–æ—Ä MuJoCo (`mpc2simulation/mj_simulator_planar.py`)

- –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –≤ MuJoCo
- –ó–∞–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π —Ç–æ—á–∫–∏ —á–µ—Ä–µ–∑ `mocap`-—Ç–µ–ª–æ (`target`) –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è —Å–∏–º—É–ª—è—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ª–æ–≥–æ–≤ –≤ –≤–∏–¥–µ –≤–∏–¥–µ–æ —Å–∏–º—É–ª—è—Ü–∏–∏ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–≤–∏–∂–µ–Ω–∏—è –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–∞

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è **–ø–ª–∞–Ω–∞—Ä–Ω–æ–≥–æ 3R –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä–∞**
- –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–∏–º–∞ –∏ –∫ UR10 ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞ –ø–æ–∑–¥–Ω–µ–µ
- **–û–±—Ö–æ–¥ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π** —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–æ–Ω—Ü–∞–º–∏ –∑–≤–µ–Ω—å–µ–≤ –∏ —Ü–µ–Ω—Ç—Ä–∞–º–∏ –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π. –¢–æ –µ—Å—Ç—å, –≤–æ–∑–º–æ–∂–Ω—ã —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –∑–≤–µ–Ω—å—è –º–æ–≥—É—Ç –∫–∞—Å–∞—Ç—å—Å—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π "–±–æ–∫–∞–º–∏". –≠—Ç–æ –º–æ–∂–Ω–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å, –≤—ã—á–∏—Å–ª—è—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤–¥–æ–ª—å –∑–≤–µ–Ω–∞ (—É–º–Ω–µ–µ –Ω–∏—á–µ–≥–æ –ø–æ–∫–∞ –Ω–µ –ø—Ä–∏–¥—É–º–∞–ª, —Ä–µ–∞–ª–∏–∑—É—é –ø–æ–∑–¥–Ω–µ–µ)

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
cd second_task
python planar_with_obstacles.py
```

---

## –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ü–ª–∞–Ω–∞—Ä–Ω—ã–π 3R –º–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä —Å –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è–º–∏

#### üîπ –†–µ–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ

![Real Results](logs/planar/real_results.png)

#### üîπ –í–∏–¥–µ–æ

<img src="logs/planar/vid.gif" width="600"/>

---

## –í–æ–∑–º–æ–∂–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ ROS2

- –ù–æ–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–¥–∞.
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ü–µ–ª–∏ –æ—Ç –≤–Ω–µ—à–Ω–µ–π ROS-–Ω–æ–¥—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è).
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è ROS2 `service` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–≤—ã–∫–ª—é—á–µ–Ω–∏—è/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π.
- –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –≤ `JointTrajectory`.
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ `Rviz` –∏ Gazebo (Ignition).